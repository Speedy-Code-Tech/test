<%- include("./partials/dashboardHeader.ejs") %>

<main>
  <div
    class="container-fluid red-border-top d-flex align-items-center pt-5 flex-column"
    style="height: 100vh"
  >
    <form action="/reply" method="post">
      <div
        class="union d-flex justify-content-center align-items-center flex-column"
      >
        <div style="max-width: 350px">
          <p class="text-center h3 ff-inter">Send him/her anonymous message</p>
          <input class="form-control my-4" name="message" type="text" />
          <input type="hidden" name="sender" value="<%= sender %>">
          <input type="hidden" name="receiver" value="<%= receiver %>">
        </div>
      </div>
      <div class="d-flex align-items-center gap-3 m-5">
        <p>Generated Link</p>
        <div class="d-flex align-items-center border border-1 url-container">
          <div class="red-box-icon border-end border-1 py-1 px-3">
            <img class="copys" src="/img/paper-icon.png" alt="asdasd" />
          </div>
          <div style="pe-2">
            <p
              class="px-3 link1"
              style="width: 200px; overflow-x: hidden; text-wrap: nowrap"
            >
              <%= url %>
            </p>
          </div>
        </div>
      </div>
      <div class="conatiner-fluid text-center">
      <button type="submit" class="btn text-white mt-3 share-btn">Reply</button>

      </div>
    </form>
  </div>
</main>
<script>
  let copylink1 = document.querySelector(".copys");
  copylink1.addEventListener("click", function () {
    const link2 = document.querySelector(".link1").textContent;

    navigator.clipboard
      .writeText(link2)
      .then(() => {
        // Use SweetAlert for success notification
        Swal.fire({
          icon: "success",
          title: "Link Copied!",
          text: "The link has been copied to your clipboard.",
          timer: 2000, // Auto-close after 2 seconds
          showConfirmButton: false,
        });
      })
      .catch((err) => {
        // Use SweetAlert for error notification
        Swal.fire({
          icon: "error",
          title: "Failed to Copy",
          text: "An error occurred while copying the link. Please try again.",
        });
        console.error("Error copying link:", err);
      });
  });
</script>

<%- include("./partials/dashboardFooter.ejs") %>
